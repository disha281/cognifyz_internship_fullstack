<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>User Manager App</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container py-5">
      <div class="card shadow-lg p-4">
        <h1 class="text-center mb-4">üë©‚Äçüíª User Manager App</h1>

        <div class="input-group mb-3">
          <input
            id="userName"
            class="form-control"
            placeholder="Enter user name"
          />
          <button class="btn btn-primary" onclick="addUser()">Add User</button>
        </div>

        <ul id="userList" class="list-group"></ul>
      </div>
    </div>

    <script>
      const apiURL = "/api/users";

      async function getUsers() {
        const res = await fetch(apiURL);
        const data = await res.json();
        const list = document.getElementById("userList");
        list.innerHTML = "";
        data.forEach((u) => {
          const li = document.createElement("li");
          li.className =
            "list-group-item d-flex justify-content-between align-items-center";
          li.innerHTML = `
            <span>${u.name}</span>
            <div>
              <button class="btn btn-sm btn-outline-danger me-2" onclick="deleteUser(${u.id})">Delete</button>
              <button class="btn btn-sm btn-outline-secondary" onclick="updateUser(${u.id})">Edit</button>
            </div>
          `;
          list.appendChild(li);
        });
      }

      async function addUser() {
        const name = document.getElementById("userName").value;
        if (!name) return alert("Enter a name first!");
        await fetch(apiURL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name }),
        });
        document.getElementById("userName").value = "";
        getUsers();
      }

      async function deleteUser(id) {
        await fetch(`${apiURL}/${id}`, { method: "DELETE" });
        getUsers();
      }

      async function updateUser(id) {
        const newName = prompt("Enter new name:");
        if (!newName) return;
        await fetch(`${apiURL}/${id}`, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name: newName }),
        });
        getUsers();
      }

      getUsers();
    </script>
  </body>
</html>
